<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LiveList - Broadcast Manager</title>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;
        const Plus = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>;
        const Edit2 = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>;
        const Trash2 = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>;
        const Calendar = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>;
        const Clock = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>;

        if (typeof window.storage === 'undefined') {
            window.storage = {
                async get(key) {
                    const value = localStorage.getItem(key);
                    return value ? { key, value, shared: false } : null;
                },
                async set(key, value) {
                    localStorage.setItem(key, value);
                    return { key, value, shared: false };
                },
                async delete(key) {
                    localStorage.removeItem(key);
                    return { key, deleted: true, shared: false };
                },
                async list(prefix) {
                    const keys = Object.keys(localStorage).filter(k => !prefix || k.startsWith(prefix));
                    return { keys, prefix, shared: false };
                }
            };
        }

        const parseTime = (timeStr) => {
            if (!timeStr || !timeStr.includes(':')) return 0;
            const [hours, minutes] = timeStr.split(':').map(Number);
            return hours * 60 + minutes;
        };

        const formatOffset = (minutes) => {
            const sign = minutes < 0 ? '-' : '+';
            const abs = Math.abs(minutes);
            const h = Math.floor(abs / 60);
            const m = abs % 60;
            return `${sign}${h}:${String(m).padStart(2, '0')}`;
        };

        const parseImportData = (text) => {
            const lines = text.trim().split('\n');
            if (lines.length < 1) return [];
            
            const groupedData = {};
            
            for (let i = 0; i < lines.length; i++) {
                const parts = lines[i].split('\t');
                if (parts.length < 13) continue;
                
                const day = parts[0];
                const broadcast = parts[1];
                const ch = parts[2];
                const start = parts[3];
                const end = parts[4];
                const booth = parts[5];
                const fp = parts[6];
                const crew = parts[7];
                const lang = parts[8];
                const game = parts[12];
                const info = parts[13] || '';
                
                const cleanGame = game ? game.trim().replace(/\s+/g, ' ') : '';
                if (!start || !cleanGame) continue;
                
                if (!groupedData[cleanGame]) {
                    groupedData[cleanGame] = {
                        id: Date.now() + Math.random(),
                        date: day,
                        channel: `${broadcast} ${ch}`.trim(),
                        startTime: start,
                        endTime: end,
                        gameName: cleanGame,
                        info: info,
                        template: 'football',
                        crews: [],
                        remarks: ''
                    };
                }
                
                if (crew && crew.trim()) {
                    groupedData[cleanGame].crews.push({ booth, fp, crew, lang });
                }
            }
            
            return Object.values(groupedData).map(event => {
                const nlCrew = event.crews.find(c => c.lang && c.lang.includes('NL'));
                const frCrew = event.crews.find(c => c.lang && c.lang.includes('FR'));
                
                return {
                    ...event,
                    boothNL: nlCrew?.booth || '',
                    crewNL: nlCrew?.crew || '',
                    fpNL: nlCrew?.fp || '',
                    boothFR: frCrew?.booth || '',
                    crewFR: frCrew?.crew || '',
                    fpFR: frCrew?.fp || '',
                    isActive: event.crews.length > 1,
                    checks: { boothCheck: false, nlIn: false, nlSync: false, frIn: false, frSync: false, goingLive: false }
                };
            });
        };

        function App() {
            const [view, setView] = useState('dashboard');
            const [currentTime, setCurrentTime] = useState(new Date());
            const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0]);
            const [templates, setTemplates] = useState([]);
            const [events, setEvents] = useState([]);

            useEffect(() => {
                loadTemplates();
                loadEvents();
                const timer = setInterval(() => setCurrentTime(new Date()), 1000);
                return () => clearInterval(timer);
            }, []);

            const loadTemplates = async () => {
                try {
                    const result = await window.storage.list('template:');
                    if (result?.keys?.length > 0) {
                        const loaded = await Promise.all(result.keys.map(async (key) => {
                            try {
                                const item = await window.storage.get(key);
                                return item ? JSON.parse(item.value) : null;
                            } catch { return null; }
                        }));
                        setTemplates(loaded.filter(t => t !== null));
                    } else {
                        const defaultTemplate = {
                            id: 'football', name: 'Football Match',
                            boothCheckOffset: -90, crewInOffset: -75,
                            syncTestOffset: -60, goingLiveOffset: -10, halfTimeOffset: 50
                        };
                        await window.storage.set('template:football', JSON.stringify(defaultTemplate));
                        setTemplates([defaultTemplate]);
                    }
                } catch (error) { console.log('Error loading templates'); }
            };

            const loadEvents = async () => {
                try {
                    const result = await window.storage.list('event:');
                    if (result?.keys) {
                        const loaded = await Promise.all(result.keys.map(async (key) => {
                            try {
                                const item = await window.storage.get(key);
                                return item ? JSON.parse(item.value) : null;
                            } catch { return null; }
                        }));
                        setEvents(loaded.filter(e => e !== null));
                    }
                } catch (error) { console.log('No events found'); }
            };

            const saveTemplate = async (template) => {
                await window.storage.set(`template:${template.id}`, JSON.stringify(template));
                await loadTemplates();
            };

            const deleteTemplate = async (id) => {
                await window.storage.delete(`template:${id}`);
                await loadTemplates();
            };

            const saveEvent = async (event) => {
                await window.storage.set(`event:${event.id}`, JSON.stringify(event));
                await loadEvents();
            };

            const deleteEvent = async (id) => {
                await window.storage.delete(`event:${id}`);
                await loadEvents();
            };

            const importEvents = async (importedEvents) => {
                for (const event of importedEvents) {
                    await saveEvent(event);
                }
            };

            return (
                <div className="min-h-screen bg-gray-100">
                    <header className="bg-blue-600 text-white p-4 shadow-lg">
                        <div className="max-w-full mx-auto flex justify-between items-center px-4">
                            <h1 className="text-2xl font-bold">LiveList Broadcast Manager</h1>
                            <div className="flex items-center gap-2 text-xl font-mono bg-blue-700 px-6 py-3 rounded-lg">
                                <Clock /> {currentTime.toLocaleTimeString()}
                            </div>
                        </div>
                    </header>
                    <nav className="bg-white shadow-md">
                        <div className="max-w-full mx-auto px-4">
                            <div className="flex gap-4 py-3">
                                {['dashboard', 'templates', 'import'].map(v => (
                                    <button key={v} onClick={() => setView(v)}
                                        className={`px-4 py-2 rounded-lg font-medium transition-colors ${view === v ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}>
                                        {v.charAt(0).toUpperCase() + v.slice(1).replace('import', 'Import Events')}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </nav>
                    <main className="max-w-full p-6">
                        {view === 'dashboard' && <Dashboard events={events} templates={templates} currentTime={currentTime} selectedDate={selectedDate} setSelectedDate={setSelectedDate} saveEvent={saveEvent} deleteEvent={deleteEvent} />}
                        {view === 'templates' && <TemplateManager templates={templates} saveTemplate={saveTemplate} deleteTemplate={deleteTemplate} />}
                        {view === 'import' && <ImportEvents importEvents={importEvents} />}
                    </main>
                </div>
            );
        }

        function Dashboard({ events, templates, currentTime, selectedDate, setSelectedDate, saveEvent, deleteEvent }) {
            const [editingRemarks, setEditingRemarks] = useState(null);
            const [remarksValue, setRemarksValue] = useState('');

            const getFilteredEvents = () => {
                return events.filter(e => e.date.includes(selectedDate.split('-')[2]))
                    .sort((a, b) => parseTime(a.startTime) - parseTime(b.startTime));
            };

            const toggleCheck = async (event, checkType) => {
                const updated = { ...event };
                updated.checks[checkType] = !updated.checks[checkType];
                await saveEvent(updated);
            };

            const getTemplate = (event) => templates.find(t => t.id === event.template) || templates[0];

            const shouldHighlight = (event, checkType) => {
                if (!event.isActive || event.checks[checkType]) return false;
                const template = getTemplate(event);
                if (!template) return false;
                const startMin = parseTime(event.startTime);
                const currentMin = currentTime.getHours() * 60 + currentTime.getMinutes();
                let triggerTime;
                if (checkType === 'boothCheck') triggerTime = startMin + template.boothCheckOffset;
                else if (checkType === 'nlIn' || checkType === 'frIn') triggerTime = startMin + template.crewInOffset;
                else if (checkType === 'nlSync' || checkType === 'frSync') triggerTime = startMin + template.syncTestOffset;
                else if (checkType === 'goingLive') triggerTime = startMin + template.goingLiveOffset;
                else return false;
                return currentMin >= triggerTime;
            };

            const getCheckboxClass = (event, checkType) => {
                if (!event.isActive) return 'cursor-not-allowed opacity-30';
                if (event.checks[checkType]) return 'bg-green-400';
                if (shouldHighlight(event, checkType)) return 'bg-yellow-300';
                return 'bg-white';
            };

            const getEventStatusColor = (event) => {
                if (!event.isActive) return '';
                const startMin = parseTime(event.startTime);
                const endMin = parseTime(event.endTime);
                const currentMin = currentTime.getHours() * 60 + currentTime.getMinutes();
                const template = getTemplate(event);
                if (currentMin < startMin + (template?.boothCheckOffset || -90)) return 'bg-orange-200';
                if (currentMin < startMin) return 'bg-orange-300';
                if (currentMin >= startMin && currentMin < startMin + 5) return 'bg-green-500 text-white font-bold';
                if (currentMin < startMin + 30) return 'bg-green-200';
                const halfTime = startMin + (template?.halfTimeOffset || 50);
                if (currentMin >= halfTime && currentMin < halfTime + 30) return 'bg-green-600 text-white font-bold';
                if (currentMin < endMin) return 'bg-green-700 text-white font-bold';
                return 'bg-gray-400 text-gray-300';
            };

            const saveRemarks = async (event) => {
                await saveEvent({ ...event, remarks: remarksValue });
                setEditingRemarks(null);
            };

            const filteredEvents = getFilteredEvents();

            return (
                <div>
                    <div className="mb-6 flex items-center gap-4 bg-white p-4 rounded-lg shadow">
                        <Calendar />
                        <input type="date" value={selectedDate} onChange={(e) => setSelectedDate(e.target.value)} className="px-4 py-2 border border-gray-300 rounded-lg" />
                        <span className="text-gray-600">Showing {filteredEvents.length} event(s)</span>
                    </div>
                    <div className="bg-white rounded-lg shadow-lg overflow-x-auto">
                        <table className="w-full text-sm border-collapse">
                            <thead className="bg-gray-100 sticky top-0">
                                <tr>
                                    <th className="border border-gray-300 px-2 py-2 text-left">CHANNEL</th>
                                    <th className="border border-gray-300 px-2 py-2 text-center">BOOTH</th>
                                    <th className="border border-gray-300 px-2 py-2 text-center text-blue-600">BTH NL</th>
                                    <th className="border border-gray-300 px-2 py-2 text-center text-blue-600">IN</th>
                                    <th className="border border-gray-300 px-2 py-2 text-left text-blue-600">CREW NL</th>
                                    <th className="border border-gray-300 px-2 py-2 text-center text-blue-600">SYNC</th>
                                    <th className="border border-gray-300 px-2 py-2 text-center text-blue-600">FP NL</th>
                                    <th className="border border-gray-300 px-2 py-2 text-center text-red-600">BTH FR</th>
                                    <th className="border border-gray-300 px-2 py-2 text-center text-red-600">IN</th>
                                    <th className="border border-gray-300 px-2 py-2 text-left text-red-600">CREW FR</th>
                                    <th className="border border-gray-300 px-2 py-2 text-center text-red-600">SYNC</th>
                                    <th className="border border-gray-300 px-2 py-2 text-center text-red-600">FP FR</th>
                                    <th className="border border-gray-300 px-2 py-2 text-center">GOING LIVE</th>
                                    <th className="border border-gray-300 px-2 py-2 text-center">START</th>
                                    <th className="border border-gray-300 px-2 py-2 text-left min-w-[300px]">GAME</th>
                                    <th className="border border-gray-300 px-2 py-2 text-center">END</th>
                                    <th className="border border-gray-300 px-2 py-2 text-left">INFO</th>
                                    <th className="border border-gray-300 px-2 py-2 text-left min-w-[150px]">REMARKS</th>
                                    <th className="border border-gray-300 px-2 py-2 text-center">DEL</th>
                                </tr>
                            </thead>
                            <tbody>
                                {filteredEvents.map(event => {
                                    const statusColor = getEventStatusColor(event);
                                    const isInactive = !event.isActive;
                                    return (
                                        <tr key={event.id} className={isInactive ? 'bg-white text-gray-300' : ''}>
                                            <td className="border border-gray-300 px-2 py-2">{event.channel}</td>
                                            <td className="border border-gray-300 px-2 py-2 text-center">
                                                {isInactive ? '--' : <input type="checkbox" checked={event.checks.boothCheck} onChange={() => toggleCheck(event, 'boothCheck')} className={`w-5 h-5 ${getCheckboxClass(event, 'boothCheck')}`} />}
                                            </td>
                                            <td className="border border-gray-300 px-2 py-2 text-center text-blue-600">{isInactive ? '--' : event.boothNL}</td>
                                            <td className="border border-gray-300 px-2 py-2 text-center">
                                                {isInactive ? '--' : <input type="checkbox" checked={event.checks.nlIn} onChange={() => toggleCheck(event, 'nlIn')} className={`w-5 h-5 ${getCheckboxClass(event, 'nlIn')}`} />}
                                            </td>
                                            <td className="border border-gray-300 px-2 py-2 text-blue-600">{isInactive ? '--' : event.crewNL}</td>
                                            <td className="border border-gray-300 px-2 py-2 text-center">
                                                {isInactive ? '--' : <input type="checkbox" checked={event.checks.nlSync} onChange={() => toggleCheck(event, 'nlSync')} className={`w-5 h-5 ${getCheckboxClass(event, 'nlSync')}`} />}
                                            </td>
                                            <td className="border border-gray-300 px-2 py-2 text-center text-blue-600">{isInactive ? '--' : event.fpNL}</td>
                                            <td className="border border-gray-300 px-2 py-2 text-center text-red-600">{isInactive ? '--' : event.boothFR}</td>
                                            <td className="border border-gray-300 px-2 py-2 text-center">
                                                {isInactive ? '--' : <input type="checkbox" checked={event.checks.frIn} onChange={() => toggleCheck(event, 'frIn')} className={`w-5 h-5 ${getCheckboxClass(event, 'frIn')}`} />}
                                            </td>
                                            <td className="border border-gray-300 px-2 py-2 text-red-600">{isInactive ? '--' : event.crewFR}</td>
                                            <td className="border border-gray-300 px-2 py-2 text-center">
                                                {isInactive ? '--' : <input type="checkbox" checked={event.checks.frSync} onChange={() => toggleCheck(event, 'frSync')} className={`w-5 h-5 ${getCheckboxClass(event, 'frSync')}`} />}
                                            </td>
                                            <td className="border border-gray-300 px-2 py-2 text-center text-red-600">{isInactive ? '--' : event.fpFR}</td>
                                            <td className="border border-gray-300 px-2 py-2 text-center">
                                                {isInactive ? '--' : <input type="checkbox" checked={event.checks.goingLive} onChange={() => toggleCheck(event, 'goingLive')} className={`w-5 h-5 ${getCheckboxClass(event, 'goingLive')}`} />}
                                            </td>
                                            <td className={`border border-gray-300 px-2 py-2 text-center font-mono ${statusColor}`}>{event.startTime}</td>
                                            <td className={`border border-gray-300 px-2 py-2 ${statusColor}`}>{event.gameName}</td>
                                            <td className={`border border-gray-300 px-2 py-2 text-center font-mono ${statusColor}`}>{event.endTime}</td>
                                            <td className="border border-gray-300 px-2 py-2 text-xs">{event.info}</td>
                                            <td className="border border-gray-300 px-2 py-2">
                                                {editingRemarks === event.id ? (
                                                    <input type="text" value={remarksValue} onChange={(e) => setRemarksValue(e.target.value)}
                                                        onBlur={() => saveRemarks(event)} onKeyDown={(e) => e.key === 'Enter' && saveRemarks(event)}
                                                        autoFocus className="w-full px-2 py-1 border border-blue-500 rounded" />
                                                ) : (
                                                    <div onClick={() => !isInactive && (setEditingRemarks(event.id), setRemarksValue(event.remarks || ''))}
                                                        className="cursor-pointer hover:bg-gray-50 px-2 py-1 rounded min-h-[24px]">
                                                        {event.remarks || (isInactive ? '--' : 'Click...')}
                                                    </div>
                                                )}
                                            </td>
                                            <td className="border border-gray-300 px-2 py-2 text-center">
                                                <button onClick={() => confirm('Delete?') && deleteEvent(event.id)} className="text-red-600 hover:text-red-800"><Trash2 /></button>
                                            </td>
                                        </tr>
                                    );
                                })}
                            </tbody>
                        </table>
                    </div>
                    {filteredEvents.length === 0 && (
                        <div className="text-center py-12 bg-white rounded-lg shadow-lg mt-6">
                            <p className="text-lg text-gray-500">No events for this date</p>
                            <p className="text-sm text-gray-400 mt-2">Import events to get started</p>
                        </div>
                    )}
                </div>
            );
        }

        function TemplateManager({ templates, saveTemplate, deleteTemplate }) {
            const [editing, setEditing] = useState(null);
            const [formData, setFormData] = useState({ id: '', name: '', boothCheckOffset: -90, crewInOffset: -75, syncTestOffset: -60, goingLiveOffset: -10, halfTimeOffset: 50 });

            const startEdit = (template) => {
                setFormData(template || { id: Date.now().toString(), name: '', boothCheckOffset: -90, crewInOffset: -75, syncTestOffset: -60, goingLiveOffset: -10, halfTimeOffset: 50 });
                setEditing(true);
            };

            const handleSave = async () => {
                if (!formData.name) { alert('Name required'); return; }
                await saveTemplate(formData);
                setEditing(false);
            };

            return (
                <div>
                    <div className="mb-6">
                        <button onClick={() => startEdit(null)} className="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2">
                            <Plus /> Create Template
                        </button>
                    </div>
                    {editing && (
                        <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                            <h2 className="text-xl font-bold mb-4">{templates.find(t => t.id === formData.id) ? 'Edit' : 'Create'} Template</h2>
                            <div className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium mb-1">Name</label>
                                    <input type="text" value={formData.name} onChange={(e) => setFormData({...formData, name: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                                </div>
                                <div className="grid grid-cols-2 gap-4">
                                    {['boothCheckOffset', 'crewInOffset', 'syncTestOffset', 'goingLiveOffset', 'halfTimeOffset'].map(field => (
                                        <div key={field}>
                                            <label className="block text-sm font-medium mb-1">{field.replace('Offset', '').replace(/([A-Z])/g, ' $1').trim()} (min)</label>
                                            <input type="number" value={field === 'halfTimeOffset' ? formData[field] : Math.abs(formData[field])}
                                                onChange={(e) => setFormData({...formData, [field]: field === 'halfTimeOffset' ? parseInt(e.target.value)||50 : -Math.abs(parseInt(e.target.value)||0)})}
                                                className="w-full px-4 py-2 border rounded-lg" />
                                        </div>
                                    ))}
                                </div>
                                <div className="flex gap-2">
                                    <button onClick={handleSave} className="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Save</button>
                                    <button onClick={() => setEditing(false)} className="bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400">Cancel</button>
                                </div>
                            </div>
                        </div>
                    )}
                    <div className="space-y-4">
                        {templates.map(t => (
                            <div key={t.id} className="bg-white rounded-lg shadow-lg p-6">
                                <div className="flex justify-between items-start">
                                    <div>
                                        <h3 className="text-lg font-bold">{t.name}</h3>
                                        <div className="text-sm text-gray-600 mt-2 space-y-1">
                                            <div>Booth Check: KO {formatOffset(t.boothCheckOffset)}</div>
                                            <div>Crew In: KO {formatOffset(t.crewInOffset)}</div>
                                            <div>Sync Test: KO {formatOffset(t.syncTestOffset)}</div>
                                            <div>Going Live: KO {formatOffset(t.goingLiveOffset)}</div>
                                            <div>Half-time: KO +{t.halfTimeOffset} min</div>
                                        </div>
                                    </div>
                                    <div className="flex gap-2">
                                        <button onClick={() => startEdit(t)} className="text-blue-600 hover:text-blue-800 p-2"><Edit2 /></button>
                                        <button onClick={() => confirm('Delete?') && deleteTemplate(t.id)} className="text-red-600 hover:text-red-800 p-2"><Trash2 /></button>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        function ImportEvents({ importEvents }) {
            const [pasteData, setPasteData] = useState('');
            const [preview, setPreview] = useState([]);

            const handleImport = async () => {
                if (preview.length === 0) return;
                await importEvents(preview);
                setPasteData('');
                setPreview([]);
                alert(`Imported ${preview.length} events!`);
            };

            return (
                <div className="space-y-6">
                    <div className="bg-white rounded-lg shadow-lg p-6">
                        <h2 className="text-xl font-bold mb-4">Import Events from Spreadsheet</h2>
                        <div className="space-y-4">
                            <div>
                                <label className="block text-sm font-medium mb-2">Paste data from spreadsheet (no headers):</label>
                                <textarea value={pasteData} onChange={(e) => setPasteData(e.target.value)}
                                    className="w-full h-48 px-4 py-2 border border-gray-300 rounded-lg font-mono text-sm"
                                    placeholder="Paste your spreadsheet data here..." />
                            </div>
                            <button onClick={() => setPreview(parseImportData(pasteData))} disabled={!pasteData.trim()}
                                className="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 disabled:bg-gray-400">
                                Parse Data
                            </button>
                        </div>
                    </div>
                    {preview.length > 0 && (
                        <div className="bg-white rounded-lg shadow-lg p-6">
                            <h3 className="text-lg font-bold mb-4">Preview ({preview.length} events found)</h3>
                            <div className="space-y-3 mb-6 max-h-96 overflow-y-auto">
                                {preview.map((event, idx) => (
                                    <div key={idx} className={`border rounded-lg p-3 ${event.isActive ? 'border-blue-300 bg-blue-50' : 'border-gray-300 bg-gray-50'}`}>
                                        <div className="font-medium">{event.gameName}</div>
                                        <div className="text-sm text-gray-600 mt-1">{event.date} | {event.startTime} - {event.endTime} | {event.channel}</div>
                                        <div className="text-xs text-gray-500 mt-1">
                                            {event.isActive ? (
                                                <>NL: {event.crewNL} ({event.boothNL}, {event.fpNL}) | FR: {event.crewFR} ({event.boothFR}, {event.fpFR})</>
                                            ) : (
                                                <span className="text-orange-600">No crew assigned - display only</span>
                                            )}
                                        </div>
                                    </div>
                                ))}
                            </div>
                            <div className="flex gap-2">
                                <button onClick={handleImport} className="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">
                                    Import {preview.length} Event(s)
                                </button>
                                <button onClick={() => { setPreview([]); setPasteData(''); }}
                                    className="bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400">
                                    Cancel
                                </button>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>